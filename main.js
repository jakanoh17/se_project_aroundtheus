!function(){"use strict";class e{constructor(e,t,s,i,r){this.data=e,this.cardSelector=t,this._handleImageClick=s,this._handleTrashClick=i,this._handleLikeClick=r,this._element=document.querySelector(this.cardSelector).content.querySelector(".gallery__card").cloneNode(!0),this._location=this._element.querySelector(".gallery__location"),this._image=this._element.querySelector(".gallery__image"),this._likeButton=this._element.querySelector(".gallery__like-button"),this._trashButton=this._element.querySelector(".gallery__trash-icon")}_setEventListeners(){this._trashButton.addEventListener("click",this._handleTrashClick),this._image.addEventListener("click",this._handleImageClick),this._likeButton.addEventListener("click",(e=>{this._selectLikeButton(e)}))}_selectLikeButton(e){this._likeButton.classList.toggle("gallery__like-button_selected"),this._likeButton.classList.contains("gallery__like-button_selected")?this._handleLikeClick(e,"PUT"):this._handleLikeClick(e,"DELETE")}render(){return this._location.textContent=this.data.name,this._image.setAttribute("alt",this.data.name),this._image.setAttribute("src",this.data.link),this._element.id=this.data._id,this._setEventListeners(),this.data.isLiked&&this._likeButton.classList.add("gallery__like-button_selected"),this._element}}const t=document.querySelector(".profile__edit-button"),s=document.forms["edit-form"],i=document.forms["edit-avi-form"],r=document.querySelector(".profile__add-button"),n=document.querySelector(".profile__avatar-container"),o=document.querySelector(".modal_type_new-card"),a=document.forms["new-card-form"],l=(o.querySelector(".modal__input_type_card-title"),o.querySelector(".modal__input_type_card-link"),{formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_inactive",inputErrorClass:"modal__input_invalid",errorClass:"modal__error-message_visible"}),c=document.querySelector(".modal__input_type_name"),d=document.querySelector(".modal__input_type_description"),u=document.querySelector(".profile__name"),_=document.querySelector(".profile__title"),h={authorization:"1e41f1e9-9859-4a6e-b008-27b738619ee0","Content-Type":"application/json"};class m{constructor(e,t){let{items:s,renderer:i}=e;this._items=s,this._renderer=i,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._element=this._renderer(e),this._addItem(this._element)}))}_addItem(){this._container.append(this._element)}}class p{constructor(e){this.popup=document.querySelector(e),this._closeButton=this.popup.querySelector(".modal__close-button"),this._boundCloseHandler=this.close.bind(this),this._boundOutsideClickHandler=this._handleOutsideClick.bind(this),this._boundEscHandler=this._handleEscClose.bind(this)}open(){this.popup.classList.add("modal_opened"),this.popup.addEventListener("click",this._boundOutsideClickHandler),document.addEventListener("keydown",this._boundEscHandler),this._closeButton.addEventListener("click",this._boundCloseHandler)}close(){this.popup.classList.remove("modal_opened"),this.popup.removeEventListener("click",this._boundOutsideClickHandler),document.removeEventListener("keydown",this._boundEscHandler),this._closeButton.removeEventListener("click",this._boundCloseHandler)}_handleEscClose(e){"Escape"===e.key&&this.close()}_handleOutsideClick(e){e.target===this.popup&&this.close()}}class g extends p{constructor(e,t){super(e),this._handleSubmit=t.bind(this)}_getInputValues(){const e=[...this.popup.querySelectorAll("input")],t={};for(const s of e)t[s.name]=s.value;return t}open(){super.open(),this.popup.addEventListener("submit",(e=>{this._handleSubmit(this._getInputValues())}))}}class y{constructor(e,t){this.settings=e,this.form=t,this._submitButton=t.querySelector(this.settings.submitButtonSelector),this._inputList=this.form.querySelectorAll(this.settings.inputSelector)}_findInvalidInputs(){return Array.from(this.form.querySelectorAll(this.settings.inputSelector)).some((e=>!e.validity.valid))}_toggleSubmitButton(e){"disable"===e||this._findInvalidInputs()?(this._submitButton.setAttribute("disabled",!0),this._submitButton.classList.add(this.settings.inactiveButtonClass)):(this._submitButton.removeAttribute("disabled"),this._submitButton.classList.remove(this.settings.inactiveButtonClass))}_toggleInputError(e){e.validity.valid?this._hideErrorMessage(e):this._showErrorMessage(e)}_showErrorMessage(e){const t=e.validationMessage,s=this.form.querySelector(`.${e.id}-err-msg`);s.textContent=t,s.classList.add(this.settings.errorClass),e.classList.add(this.settings.inputErrorClass)}_hideErrorMessage(e){this.form.querySelector(`.${e.id}-err-msg`).classList.remove(this.settings.errorClass),e.classList.remove(this.settings.inputErrorClass)}enableValidation(){this._inputList.forEach((e=>{e.addEventListener("input",(e=>{this._toggleInputError(e.target),this._toggleSubmitButton()}))}))}resetValidation(){this._toggleSubmitButton("disable"),this._inputList.forEach((e=>{this._hideErrorMessage(e)}))}}class v{constructor(e){this.options=e}_definePromise(e){return fetch(e,this.options).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>console.error(e)))}getUserInfo(){return this._definePromise("https://around-api.en.tripleten-services.com/v1/users/me")}getInitialCards(){return this._definePromise("https://around-api.en.tripleten-services.com/v1/cards")}deleteCardInfo(e){return this._definePromise(`https://around-api.en.tripleten-services.com/v1/cards/${e}`)}toggleLikeCard(e){return this._definePromise(`https://around-api.en.tripleten-services.com/v1/cards/${e}/likes`)}editAvatar(){return this._definePromise("https://around-api.en.tripleten-services.com/v1/users/me/avatar")}}const b=new y(l,a),S=new y(l,s),f=new y(l,i),C=new class extends p{constructor(e){super(e),this._enlrgImg=this.popup.querySelector(".modal__enlarged-image"),this._enlrgImgCap=this.popup.querySelector(".modal__caption")}open(e){super.open(),this._enlrgImg.src=e.target.src,this._enlrgImg.alt=e.target.alt,this._enlrgImgCap.textContent=e.target.alt}}(".modal_type_enlarged-card"),k=new g(".modal_type_new-card",(function(e){let{name:t,link:s}=e;const i=new v({method:"POST",headers:h,body:JSON.stringify({name:t,link:s})});k.popup.querySelector(".modal__submit-button").textContent="Creating...",i.getInitialCards().then((e=>{new m({items:e,renderer:x},".gallery").renderItems()})).catch((e=>console.error(e))).finally((()=>{k.popup.querySelector(".modal__submit-button").textContent="Create",k.close(),a.reset(),b.resetValidation()}))})),E=new g(".modal_type_profile",(function(e){let{name:t,description:s}=e;const i=new v({method:"PATCH",headers:h,body:JSON.stringify({name:t,about:s})});E.popup.querySelector(".modal__submit-button").textContent="Saving...",i.getUserInfo().catch((e=>{console.error(`Error: ${e}`)})).finally((()=>{E.popup.querySelector(".modal__submit-button").textContent="Save",E.close()}))})),L=new g(".modal_type_delete-card",(function(e){let{cardId:t}=e;L.close(),B.deleteCardInfo(t).catch((e=>{console.error(e)}))})),q=new g(".modal_type_edit-avi",(function(e){const t=new v({method:"PATCH",headers:h,body:JSON.stringify(e)});q.popup.querySelector(".modal__submit-button").textContent="Saving...",t.editAvatar().then((e=>{I.setAvatar(e)})).catch((e=>{console.error(e)})).finally((()=>{q.popup.querySelector(".modal__submit-button").textContent="Save",i.reset(),q.close()}))})),I=new class{constructor(e){let{userNameSelec:t,descrSelec:s,aviSelec:i}=e;this.userName=document.querySelector(t),this.descr=document.querySelector(s),this.avatar=document.querySelector(i)}setUserInfo(e){let{name:t,description:s,avatar:i}=e;this.userName.textContent=t,this.descr.textContent=s,this.avatar.src=i}}({userNameSelec:".profile__name",descrSelec:".profile__title",aviSelec:".profile__avatar"}),w=new v({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:h}),B=new v({method:"DELETE",headers:h});function x(t){return new e(t,"#card-template",A,H,P).render()}function A(e){C.open(e)}function H(e){L.open(),L.popup.querySelector("input").value=e.target.closest(".gallery__card").id}function P(e,t){new v({method:t,headers:h}).toggleLikeCard(e.target.closest(".gallery__card").id)}w.getUserInfo().then((e=>{const{name:t,about:s,avatar:i}=e;I.setUserInfo({name:t,description:s,avatar:i})})).catch((e=>console.error(e))),w.getInitialCards().then((e=>{new m({items:e,renderer:x},".gallery").renderItems()})).catch((e=>console.error(e))),r.addEventListener("click",(()=>{k.open()})),t.addEventListener("click",(function(){E.open(),c.value=u.textContent,d.value=_.textContent,S.resetValidation()})),n.addEventListener("click",(()=>{q.open(),f.resetValidation()})),b.enableValidation(),S.enableValidation(),f.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUV4RHRDLE9BQU9DLEdBQVFDLFFBQVFDLE1BQU1GLEtBY2hDK0MsRUFDRzNDLGtCQUNBWixNQUFNMUgsSUFDa0IsSUFBSXVELEVBQ3pCLENBQUVHLE1BQU8xRCxFQUFNMkQsU0FBVWdHLEdBQ3pCLFlBR2E1RixhQUFhLElBRTdCa0UsT0FBT0MsR0FBUUMsUUFBUUMsTUFBTUYsS0FxSGhDNUYsRUFBY25CLGlCQUFpQixTQUFTLEtBQ3RDZ0ksRUFBaUJwRSxNQUFNLElBR3pCN0MsRUFBa0JmLGlCQUFpQixTQUFTLFdBQzFDMkksRUFBYy9FLE9BQ2Q5QixFQUFjNEMsTUFBUTFDLEVBQVN6QixZQUMvQndCLEVBQWUyQyxNQUFRekMsRUFBVTFCLFlBQ2pDa0gsRUFBcUJ4QixpQkFDdkIsSUFFQTdFLEVBQWNwQixpQkFBaUIsU0FBUyxLQUN0Q21KLEVBQWlCdkYsT0FDakI4RCxFQUFxQnpCLGlCQUFpQixJQUl4Q3VCLEVBQXFCeEIsbUJBQ3JCeUIsRUFBcUJ6QixtQkFDckIwQixFQUFxQjFCLGtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vY3JlYXRlcyBjYXJkIGVsZW1lbnQgdyBldmVudCBsaXN0ZW5lcnNcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBkYXRhLFxyXG4gICAgY2FyZFNlbGVjdG9yLFxyXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcclxuICAgIGhhbmRsZVRyYXNoQ2xpY2ssXHJcbiAgICBoYW5kbGVMaWtlQ2xpY2tcclxuICApIHtcclxuICAgIHRoaXMuZGF0YSA9IGRhdGE7XHJcbiAgICB0aGlzLmNhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlVHJhc2hDbGljayA9IGhhbmRsZVRyYXNoQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XHJcblxyXG4gICAgdGhpcy5fZWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2NhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICAgIHRoaXMuX2xvY2F0aW9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2xvY2F0aW9uXCIpO1xyXG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fdHJhc2hCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fdHJhc2gtaWNvblwiKTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3RyYXNoQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVUcmFzaENsaWNrKTtcclxuICAgIHRoaXMuX2ltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKTtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgICAgdGhpcy5fc2VsZWN0TGlrZUJ1dHRvbihldnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfc2VsZWN0TGlrZUJ1dHRvbihldnQpIHtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImdhbGxlcnlfX2xpa2UtYnV0dG9uX3NlbGVjdGVkXCIpO1xyXG4gICAgaWYgKHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKFwiZ2FsbGVyeV9fbGlrZS1idXR0b25fc2VsZWN0ZWRcIikpIHtcclxuICAgICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrKGV2dCwgXCJQVVRcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2soZXZ0LCBcIkRFTEVURVwiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIHRoaXMuX2xvY2F0aW9uLnRleHRDb250ZW50ID0gdGhpcy5kYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9pbWFnZS5zZXRBdHRyaWJ1dGUoXCJhbHRcIiwgdGhpcy5kYXRhLm5hbWUpO1xyXG4gICAgdGhpcy5faW1hZ2Uuc2V0QXR0cmlidXRlKFwic3JjXCIsIHRoaXMuZGF0YS5saW5rKTtcclxuICAgIHRoaXMuX2VsZW1lbnQuaWQgPSB0aGlzLmRhdGEuX2lkO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICBpZiAodGhpcy5kYXRhLmlzTGlrZWQpIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiZ2FsbGVyeV9fbGlrZS1idXR0b25fc2VsZWN0ZWRcIik7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZU1vZGFsRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiZWRpdC1mb3JtXCJdO1xyXG5leHBvcnQgY29uc3QgZWRpdEF2aUZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImVkaXQtYXZpLWZvcm1cIl07XHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgZWRpdEF2aUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fYXZhdGFyLWNvbnRhaW5lclwiXHJcbik7XHJcbmNvbnN0IG5ld0NhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfdHlwZV9uZXctY2FyZFwiKTtcclxuZXhwb3J0IGNvbnN0IG5ld0NhcmRNb2RhbEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcIm5ldy1jYXJkLWZvcm1cIl07XHJcbmV4cG9ydCBjb25zdCBuZXdDYXJkVGl0bGUgPSBuZXdDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcclxuICBcIi5tb2RhbF9faW5wdXRfdHlwZV9jYXJkLXRpdGxlXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IG5ld0NhcmRMaW5rID0gbmV3Q2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWxfX2lucHV0X3R5cGVfY2FyZC1saW5rXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25Db25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3N1Ym1pdC1idXR0b25faW5hY3RpdmVcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X2ludmFsaWRcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvci1tZXNzYWdlX3Zpc2libGVcIixcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcm9mTmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW5wdXRfdHlwZV9uYW1lXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZkRlc2NySW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLm1vZGFsX19pbnB1dF90eXBlX2Rlc2NyaXB0aW9uXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZkRlc2NyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcclxuZXhwb3J0IGNvbnN0IGFwaUhlYWRlcnMgPSB7XHJcbiAgYXV0aG9yaXphdGlvbjogXCIxZTQxZjFlOS05ODU5LTRhNmUtYjAwOC0yN2I3Mzg2MTllZTBcIixcclxuICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxufTtcclxuIiwiLy9hZGRzIGNhcmQgZWxlbWVudCB0byBET007IHBhc3NlcyBDYXJkIG1vZHVsZSB0aHJvdWdoIGluIHRoZVxyXG4vL1wicmVuZGVyZXJcIiBzbyBvbmx5IG5lZWQgdG8gY2FsbCB1cCBTZWN0aW9uIG1vZHVsZSBmb3IgYm90aCBjYXJkIGVsZW0uIGFuZCBET00gY3JlYXRpb25cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIHNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgICAgdGhpcy5fYWRkSXRlbSh0aGlzLl9lbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2FkZEl0ZW0oKSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIuYXBwZW5kKHRoaXMuX2VsZW1lbnQpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMucG9wdXAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fYm91bmRDbG9zZUhhbmRsZXIgPSB0aGlzLmNsb3NlLmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLl9ib3VuZE91dHNpZGVDbGlja0hhbmRsZXIgPSB0aGlzLl9oYW5kbGVPdXRzaWRlQ2xpY2suYmluZCh0aGlzKTtcclxuICAgIHRoaXMuX2JvdW5kRXNjSGFuZGxlciA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5wb3B1cC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgdGhpcy5wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5fYm91bmRPdXRzaWRlQ2xpY2tIYW5kbGVyKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2JvdW5kRXNjSGFuZGxlcik7XHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5fYm91bmRDbG9zZUhhbmRsZXIpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLnBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICB0aGlzLnBvcHVwLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9ib3VuZE91dHNpZGVDbGlja0hhbmRsZXIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5fYm91bmRFc2NIYW5kbGVyKTtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9ib3VuZENsb3NlSGFuZGxlcik7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlT3V0c2lkZUNsaWNrKGV2dCkge1xyXG4gICAgaWYgKGV2dC50YXJnZXQgPT09IHRoaXMucG9wdXApIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGhhbmRsZVN1Ym1pdC5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgaW5wdXRMaXN0ID0gWy4uLnRoaXMucG9wdXAucXVlcnlTZWxlY3RvckFsbChcImlucHV0XCIpXTtcclxuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XHJcblxyXG4gICAgZm9yIChjb25zdCBpbnB1dCBvZiBpbnB1dExpc3QpIHtcclxuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gICAgdGhpcy5wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgICAvLyBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybSkge1xyXG4gICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xyXG4gICAgdGhpcy5mb3JtID0gZm9ybTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IGZvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLnNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuc2V0dGluZ3MuaW5wdXRTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBfZmluZEludmFsaWRJbnB1dHMoKSB7XHJcbiAgICBjb25zdCBmb3JtSW5wdXRzID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5zZXR0aW5ncy5pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuICAgIHJldHVybiBmb3JtSW5wdXRzLnNvbWUoKGlucHV0KSA9PiB7XHJcbiAgICAgIHJldHVybiAhaW5wdXQudmFsaWRpdHkudmFsaWQ7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF90b2dnbGVTdWJtaXRCdXR0b24ocGFyYW0pIHtcclxuICAgIGlmIChwYXJhbSA9PT0gXCJkaXNhYmxlXCIgfHwgdGhpcy5fZmluZEludmFsaWRJbnB1dHMoKSkge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24ucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dFcnJvck1lc3NhZ2UoaW5wdXRFbGVtZW50KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVFcnJvck1lc3NhZ2UoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zaG93RXJyb3JNZXNzYWdlKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5mb3JtLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyLW1zZ2ApO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5zZXR0aW5ncy5lcnJvckNsYXNzKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlRXJyb3JNZXNzYWdlKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5mb3JtLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyLW1zZ2ApO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5zZXR0aW5ncy5lcnJvckNsYXNzKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUlucHV0RXJyb3IoZXZ0LnRhcmdldCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlU3VibWl0QnV0dG9uKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl90b2dnbGVTdWJtaXRCdXR0b24oXCJkaXNhYmxlXCIpO1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlRXJyb3JNZXNzYWdlKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xyXG4gIH1cclxuXHJcbiAgX2RlZmluZVByb21pc2UodXJsKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godXJsLCB0aGlzLm9wdGlvbnMpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihlcnIpKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2RlZmluZVByb21pc2UoXHJcbiAgICAgIFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjEvdXNlcnMvbWVcIlxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiB0aGlzLl9kZWZpbmVQcm9taXNlKFxyXG4gICAgICBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxL2NhcmRzXCJcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkSW5mbyhjYXJkSWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9kZWZpbmVQcm9taXNlKFxyXG4gICAgICBgaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjEvY2FyZHMvJHtjYXJkSWR9YFxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHRvZ2dsZUxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2RlZmluZVByb21pc2UoXHJcbiAgICAgIGBodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgZWRpdEF2YXRhcigpIHtcclxuICAgIHJldHVybiB0aGlzLl9kZWZpbmVQcm9taXNlKFxyXG4gICAgICBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxL3VzZXJzL21lL2F2YXRhclwiXHJcbiAgICApO1xyXG4gIH1cclxufVxyXG5cclxuLy9jb21lIGJhY2sgdG8gdGhpczsgcmVmOiBHZW4gcmVjcyAjNVxyXG5mdW5jdGlvbiBzZXRXZWJwYWdlU3RhcnQoKSB7XHJcbiAgcmV0dXJuIFByb21pc2UuYWxsKGNhcmRQcm9taXNlcyk7XHJcbn1cclxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIGVkaXRQcm9maWxlQnV0dG9uLFxyXG4gIGFkZENhcmRCdXR0b24sXHJcbiAgbmV3Q2FyZE1vZGFsRm9ybSxcclxuICBwcm9mTmFtZUlucHV0LFxyXG4gIHByb2ZEZXNjcklucHV0LFxyXG4gIHZhbGlkYXRpb25Db25maWcsXHJcbiAgcHJvZmlsZU1vZGFsRm9ybSxcclxuICBhcGlIZWFkZXJzLFxyXG4gIGVkaXRBdmlCdXR0b24sXHJcbiAgZWRpdEF2aUZvcm0sXHJcbiAgcHJvZk5hbWUsXHJcbiAgcHJvZkRlc2NyLFxyXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5cclxuLy9DTEFTUyBJTlNUQU5DRVNcclxuY29uc3QgbmV3Q2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICB2YWxpZGF0aW9uQ29uZmlnLFxyXG4gIG5ld0NhcmRNb2RhbEZvcm1cclxuKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgdmFsaWRhdGlvbkNvbmZpZyxcclxuICBwcm9maWxlTW9kYWxGb3JtXHJcbik7XHJcblxyXG5jb25zdCBlZGl0QXZpRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25Db25maWcsIGVkaXRBdmlGb3JtKTtcclxuY29uc3QgZW5scmdJbWdQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIi5tb2RhbF90eXBlX2VubGFyZ2VkLWNhcmRcIik7XHJcbmNvbnN0IG5ld0NhcmRGb3JtUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIi5tb2RhbF90eXBlX25ldy1jYXJkXCIsXHJcbiAgaGFuZGxlTmV3Q2FyZEZvcm1TdWJtaXRcclxuKTtcclxuY29uc3QgcHJvZkZvcm1Qb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiLm1vZGFsX3R5cGVfcHJvZmlsZVwiLFxyXG4gIGhhbmRsZVByb2ZpbGVTdWJtaXRcclxuKTtcclxuY29uc3QgZGVsQ2FyZEZvcm1Qb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiLm1vZGFsX3R5cGVfZGVsZXRlLWNhcmRcIixcclxuICBoYW5kbGVEZWxDYXJkU3VibWl0XHJcbik7XHJcbmNvbnN0IGVkaXRBdmlGb3JtUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIi5tb2RhbF90eXBlX2VkaXQtYXZpXCIsXHJcbiAgaGFuZGxlRWRpdEF2aVN1Ym1pdFxyXG4pO1xyXG5jb25zdCBwcm9mVXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIHVzZXJOYW1lU2VsZWM6IFwiLnByb2ZpbGVfX25hbWVcIixcclxuICBkZXNjclNlbGVjOiBcIi5wcm9maWxlX190aXRsZVwiLFxyXG4gIGF2aVNlbGVjOiBcIi5wcm9maWxlX19hdmF0YXJcIixcclxufSk7XHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiBhcGlIZWFkZXJzLFxyXG59KTtcclxuY29uc3QgZGVsQ2FyZEFwaSA9IG5ldyBBcGkoe1xyXG4gIG1ldGhvZDogXCJERUxFVEVcIixcclxuICBoZWFkZXJzOiBhcGlIZWFkZXJzLFxyXG59KTtcclxuXHJcbi8vSU5JVElBTExZIFNFVCBVU0VSIElORk9cclxuYXBpXHJcbiAgLmdldFVzZXJJbmZvKClcclxuICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgY29uc3QgeyBuYW1lLCBhYm91dDogZGVzY3JpcHRpb24sIGF2YXRhciB9ID0gZGF0YTtcclxuICAgIHByb2ZVc2VySW5mby5zZXRVc2VySW5mbyh7IG5hbWUsIGRlc2NyaXB0aW9uLCBhdmF0YXIgfSk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihlcnIpKTtcclxuXHJcbi8vIFBPUFVMQVRFIElOSVRJQUwgQ0FSRFNcclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUNhcmQoZGF0YSkge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gbmV3IENhcmQoXHJcbiAgICBkYXRhLFxyXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gICAgaGFuZGxlQ2FyZEVubGFyZ2VtZW50LFxyXG4gICAgaGFuZGxlVHJhc2hDbGljayxcclxuICAgIHNlbmRMaWtlUmVxXHJcbiAgKTtcclxuICByZXR1cm4gY2FyZEVsZW1lbnQucmVuZGVyKCk7XHJcbn1cclxuXHJcbmFwaVxyXG4gIC5nZXRJbml0aWFsQ2FyZHMoKVxyXG4gIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICBjb25zdCBpbml0aWFsU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gICAgICB7IGl0ZW1zOiBkYXRhLCByZW5kZXJlcjogY3JlYXRlQ2FyZCB9LFxyXG4gICAgICBcIi5nYWxsZXJ5XCJcclxuICAgICk7XHJcblxyXG4gICAgaW5pdGlhbFNlY3Rpb24ucmVuZGVySXRlbXMoKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpO1xyXG5cclxuLy8gRU5MQVJHRSBDQVJEIElNQUdFXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRFbmxhcmdlbWVudChldnQpIHtcclxuICBlbmxyZ0ltZ1BvcHVwLm9wZW4oZXZ0KTtcclxufVxyXG5cclxuLy8gU1VCTUlUIE5FVyBDQVJEIE1PREFMXHJcbmZ1bmN0aW9uIGhhbmRsZU5ld0NhcmRGb3JtU3VibWl0KHsgbmFtZSwgbGluayB9KSB7XHJcbiAgY29uc3QgbmV3Q2FyZEFwaSA9IG5ldyBBcGkoe1xyXG4gICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgIGhlYWRlcnM6IGFwaUhlYWRlcnMsXHJcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgIG5hbWUsXHJcbiAgICAgIGxpbmssXHJcbiAgICB9KSxcclxuICB9KTtcclxuICBuZXdDYXJkRm9ybVBvcHVwLnBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIikudGV4dENvbnRlbnQgPVxyXG4gICAgXCJDcmVhdGluZy4uLlwiO1xyXG4gIG5ld0NhcmRBcGlcclxuICAgIC5nZXRJbml0aWFsQ2FyZHMoKVxyXG4gICAgLnRoZW4oKG5ld0NhcmREYXRhKSA9PiB7XHJcbiAgICAgIGNvbnN0IG5ld0NhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAgICAgICAgeyBpdGVtczogbmV3Q2FyZERhdGEsIHJlbmRlcmVyOiBjcmVhdGVDYXJkIH0sXHJcbiAgICAgICAgXCIuZ2FsbGVyeVwiXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBuZXdDYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIG5ld0NhcmRGb3JtUG9wdXAucG9wdXAucXVlcnlTZWxlY3RvcihcclxuICAgICAgICBcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiXHJcbiAgICAgICkudGV4dENvbnRlbnQgPSBcIkNyZWF0ZVwiO1xyXG4gICAgICBuZXdDYXJkRm9ybVBvcHVwLmNsb3NlKCk7XHJcbiAgICAgIG5ld0NhcmRNb2RhbEZvcm0ucmVzZXQoKTtcclxuICAgICAgbmV3Q2FyZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLy8gU1VCTUlUIFBST0ZJTEUgTU9EQUxcclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZVN1Ym1pdCh7IG5hbWUsIGRlc2NyaXB0aW9uOiBhYm91dCB9KSB7XHJcbiAgY29uc3QgZWRpdFByb2ZpbGVBcGkgPSBuZXcgQXBpKHtcclxuICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgaGVhZGVyczogYXBpSGVhZGVycyxcclxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgbmFtZSxcclxuICAgICAgYWJvdXQsXHJcbiAgICB9KSxcclxuICB9KTtcclxuICBwcm9mRm9ybVBvcHVwLnBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIikudGV4dENvbnRlbnQgPVxyXG4gICAgXCJTYXZpbmcuLi5cIjtcclxuICBlZGl0UHJvZmlsZUFwaVxyXG4gICAgLmdldFVzZXJJbmZvKClcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yOiAke2Vycn1gKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHByb2ZGb3JtUG9wdXAucG9wdXAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKS50ZXh0Q29udGVudCA9XHJcbiAgICAgICAgXCJTYXZlXCI7XHJcbiAgICAgIHByb2ZGb3JtUG9wdXAuY2xvc2UoKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vLyBERUxFVEUgQ0FSRCBNT0RBTFxyXG5mdW5jdGlvbiBoYW5kbGVUcmFzaENsaWNrKGV2dCkge1xyXG4gIGRlbENhcmRGb3JtUG9wdXAub3BlbigpO1xyXG4gIGRlbENhcmRGb3JtUG9wdXAucG9wdXAucXVlcnlTZWxlY3RvcihcImlucHV0XCIpLnZhbHVlID1cclxuICAgIGV2dC50YXJnZXQuY2xvc2VzdChcIi5nYWxsZXJ5X19jYXJkXCIpLmlkO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxDYXJkU3VibWl0KHsgY2FyZElkIH0pIHtcclxuICBkZWxDYXJkRm9ybVBvcHVwLmNsb3NlKCk7XHJcbiAgZGVsQ2FyZEFwaS5kZWxldGVDYXJkSW5mbyhjYXJkSWQpLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICB9KTtcclxufVxyXG5cclxuLy9MSUtFIENBUkRcclxuZnVuY3Rpb24gc2VuZExpa2VSZXEoZXZ0LCBtZXRob2QpIHtcclxuICBjb25zdCBsaWtlQ2FyZEFwaSA9IG5ldyBBcGkoe1xyXG4gICAgbWV0aG9kOiBtZXRob2QsXHJcbiAgICBoZWFkZXJzOiBhcGlIZWFkZXJzLFxyXG4gIH0pO1xyXG4gIGxpa2VDYXJkQXBpLnRvZ2dsZUxpa2VDYXJkKGV2dC50YXJnZXQuY2xvc2VzdChcIi5nYWxsZXJ5X19jYXJkXCIpLmlkKTtcclxufVxyXG5cclxuLy8gRURJVCBBVkFUQVIgRk9STVxyXG5mdW5jdGlvbiBoYW5kbGVFZGl0QXZpU3VibWl0KGF2YXRhcikge1xyXG4gIGNvbnN0IGVkaXRBdmlBcGkgPSBuZXcgQXBpKHtcclxuICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgaGVhZGVyczogYXBpSGVhZGVycyxcclxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGF2YXRhciksXHJcbiAgfSk7XHJcblxyXG4gIGVkaXRBdmlGb3JtUG9wdXAucG9wdXAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKS50ZXh0Q29udGVudCA9XHJcbiAgICBcIlNhdmluZy4uLlwiO1xyXG5cclxuICBlZGl0QXZpQXBpXHJcbiAgICAuZWRpdEF2YXRhcigpXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBwcm9mVXNlckluZm8uc2V0QXZhdGFyKGRhdGEpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGVkaXRBdmlGb3JtUG9wdXAucG9wdXAucXVlcnlTZWxlY3RvcihcclxuICAgICAgICBcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiXHJcbiAgICAgICkudGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcclxuXHJcbiAgICAgIGVkaXRBdmlGb3JtLnJlc2V0KCk7XHJcbiAgICAgIGVkaXRBdmlGb3JtUG9wdXAuY2xvc2UoKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vLyBPUEVOIE1PREFMU1xyXG5hZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgbmV3Q2FyZEZvcm1Qb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG5cclxuZWRpdFByb2ZpbGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIGlucHV0UHJvZmlsZUluZm8oKSB7XHJcbiAgcHJvZkZvcm1Qb3B1cC5vcGVuKCk7XHJcbiAgcHJvZk5hbWVJbnB1dC52YWx1ZSA9IHByb2ZOYW1lLnRleHRDb250ZW50O1xyXG4gIHByb2ZEZXNjcklucHV0LnZhbHVlID0gcHJvZkRlc2NyLnRleHRDb250ZW50O1xyXG4gIHByb2ZpbGVGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcbmVkaXRBdmlCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBlZGl0QXZpRm9ybVBvcHVwLm9wZW4oKTtcclxuICBlZGl0QXZpRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxufSk7XHJcblxyXG4vLyBGT1JNIFZBTElEQVRJT05cclxubmV3Q2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5wcm9maWxlRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmVkaXRBdmlGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fZW5scmdJbWcgPSB0aGlzLnBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2VubGFyZ2VkLWltYWdlXCIpO1xyXG4gICAgdGhpcy5fZW5scmdJbWdDYXAgPSB0aGlzLnBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XHJcbiAgfVxyXG5cclxuICBvcGVuKGV2dCkge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gICAgdGhpcy5fZW5scmdJbWcuc3JjID0gZXZ0LnRhcmdldC5zcmM7XHJcbiAgICB0aGlzLl9lbmxyZ0ltZy5hbHQgPSBldnQudGFyZ2V0LmFsdDtcclxuICAgIHRoaXMuX2VubHJnSW1nQ2FwLnRleHRDb250ZW50ID0gZXZ0LnRhcmdldC5hbHQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IHVzZXJOYW1lU2VsZWMsIGRlc2NyU2VsZWMsIGF2aVNlbGVjIH0pIHtcclxuICAgIHRoaXMudXNlck5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJOYW1lU2VsZWMpO1xyXG4gICAgdGhpcy5kZXNjciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGVzY3JTZWxlYyk7XHJcbiAgICB0aGlzLmF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZpU2VsZWMpO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oeyBuYW1lLCBkZXNjcmlwdGlvbiwgYXZhdGFyIH0pIHtcclxuICAgIHRoaXMudXNlck5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5kZXNjci50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xyXG4gICAgdGhpcy5hdmF0YXIuc3JjID0gYXZhdGFyO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVUcmFzaENsaWNrIiwiaGFuZGxlTGlrZUNsaWNrIiwidGhpcyIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZVRyYXNoQ2xpY2siLCJfaGFuZGxlTGlrZUNsaWNrIiwiX2VsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2xvY2F0aW9uIiwiX2ltYWdlIiwiX2xpa2VCdXR0b24iLCJfdHJhc2hCdXR0b24iLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZ0IiwiX3NlbGVjdExpa2VCdXR0b24iLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJjb250YWlucyIsInJlbmRlciIsInRleHRDb250ZW50IiwibmFtZSIsInNldEF0dHJpYnV0ZSIsImxpbmsiLCJpZCIsIl9pZCIsImlzTGlrZWQiLCJhZGQiLCJlZGl0UHJvZmlsZUJ1dHRvbiIsInByb2ZpbGVNb2RhbEZvcm0iLCJmb3JtcyIsImVkaXRBdmlGb3JtIiwiYWRkQ2FyZEJ1dHRvbiIsImVkaXRBdmlCdXR0b24iLCJuZXdDYXJkTW9kYWwiLCJuZXdDYXJkTW9kYWxGb3JtIiwidmFsaWRhdGlvbkNvbmZpZyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwicHJvZk5hbWVJbnB1dCIsInByb2ZEZXNjcklucHV0IiwicHJvZk5hbWUiLCJwcm9mRGVzY3IiLCJhcGlIZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsIlNlY3Rpb24iLCJfcmVmIiwic2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiZm9yRWFjaCIsIml0ZW0iLCJfYWRkSXRlbSIsImFwcGVuZCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsInBvcHVwIiwiX2Nsb3NlQnV0dG9uIiwiX2JvdW5kQ2xvc2VIYW5kbGVyIiwiY2xvc2UiLCJiaW5kIiwiX2JvdW5kT3V0c2lkZUNsaWNrSGFuZGxlciIsIl9oYW5kbGVPdXRzaWRlQ2xpY2siLCJfYm91bmRFc2NIYW5kbGVyIiwiX2hhbmRsZUVzY0Nsb3NlIiwib3BlbiIsInJlbW92ZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJ0YXJnZXQiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlU3VibWl0IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRMaXN0IiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0VmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm0iLCJfc3VibWl0QnV0dG9uIiwiX2lucHV0TGlzdCIsIl9maW5kSW52YWxpZElucHV0cyIsIkFycmF5IiwiZnJvbSIsInNvbWUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX3RvZ2dsZVN1Ym1pdEJ1dHRvbiIsInBhcmFtIiwicmVtb3ZlQXR0cmlidXRlIiwiX3RvZ2dsZUlucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJfaGlkZUVycm9yTWVzc2FnZSIsIl9zaG93RXJyb3JNZXNzYWdlIiwiZXJyb3JNZXNzYWdlIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJlbmFibGVWYWxpZGF0aW9uIiwicmVzZXRWYWxpZGF0aW9uIiwiQXBpIiwib3B0aW9ucyIsIl9kZWZpbmVQcm9taXNlIiwidXJsIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwiZ2V0VXNlckluZm8iLCJnZXRJbml0aWFsQ2FyZHMiLCJkZWxldGVDYXJkSW5mbyIsImNhcmRJZCIsInRvZ2dsZUxpa2VDYXJkIiwiZWRpdEF2YXRhciIsIm5ld0NhcmRGb3JtVmFsaWRhdG9yIiwicHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJlZGl0QXZpRm9ybVZhbGlkYXRvciIsImVubHJnSW1nUG9wdXAiLCJfZW5scmdJbWciLCJfZW5scmdJbWdDYXAiLCJzcmMiLCJhbHQiLCJuZXdDYXJkRm9ybVBvcHVwIiwibmV3Q2FyZEFwaSIsIm1ldGhvZCIsImhlYWRlcnMiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsIm5ld0NhcmREYXRhIiwiY3JlYXRlQ2FyZCIsImZpbmFsbHkiLCJyZXNldCIsInByb2ZGb3JtUG9wdXAiLCJfcmVmMiIsImRlc2NyaXB0aW9uIiwiYWJvdXQiLCJlZGl0UHJvZmlsZUFwaSIsImRlbENhcmRGb3JtUG9wdXAiLCJfcmVmMyIsImRlbENhcmRBcGkiLCJlZGl0QXZpRm9ybVBvcHVwIiwiYXZhdGFyIiwiZWRpdEF2aUFwaSIsInByb2ZVc2VySW5mbyIsInNldEF2YXRhciIsInVzZXJOYW1lU2VsZWMiLCJkZXNjclNlbGVjIiwiYXZpU2VsZWMiLCJ1c2VyTmFtZSIsImRlc2NyIiwic2V0VXNlckluZm8iLCJhcGkiLCJiYXNlVXJsIiwiaGFuZGxlQ2FyZEVubGFyZ2VtZW50Iiwic2VuZExpa2VSZXEiLCJjbG9zZXN0Il0sInNvdXJjZVJvb3QiOiIifQ==